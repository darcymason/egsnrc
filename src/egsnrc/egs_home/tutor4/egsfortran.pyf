!    -*- f90 -*-
! Note: the context of this file is case sensitive.

python module egs_combine_runs__user__routines
    interface egs_combine_runs_user_interface
        subroutine combine_routine(tmp_string) ! in :egsfortran:tutor4_linux.f:egs_combine_runs:unknown_interface
            character*1024 :: tmp_string
        end subroutine combine_routine
    end interface egs_combine_runs_user_interface
end python module egs_combine_runs__user__routines
python module egs_get_electron_data__user__routines
    interface egs_get_electron_data_user_interface
        subroutine func(e_meke_imed_err,lemin,lemax,e_esig0_1_imed_err,e_esig1_1_imed_err) ! in :egsfortran:tutor4_linux.f:egs_get_electron_data:unknown_interface
            integer*4 :: e_meke_imed_err
            real*8 :: lemin
            real*8 :: lemax
            real*8 :: e_esig0_1_imed_err
            real*8 :: e_esig1_1_imed_err
        end subroutine func
    end interface egs_get_electron_data_user_interface
end python module egs_get_electron_data__user__routines
python module egs_get_photon_data__user__routines
    interface egs_get_photon_data_user_interface
        subroutine func(e_mge_imed_err,lemin,lemax,e_gmfp0_1_imed_err,e_gmfp1_1_imed_err) ! in :egsfortran:tutor4_linux.f:egs_get_photon_data:unknown_interface
            integer*4 :: e_mge_imed_err
            real*8 :: lemin
            real*8 :: lemax
            real*8 :: e_gmfp0_1_imed_err
            real*8 :: e_gmfp1_1_imed_err
        end subroutine func
    end interface egs_get_photon_data_user_interface
end python module egs_get_photon_data__user__routines
python module electr__user__routines
    interface electr_user_interface
        subroutine ausgab(iarg) ! in :egsfortran:tutor4_linux.f:electr:unknown_interface
            intent(callback,hide) ausgab
            integer*4 :: iarg
        end subroutine ausgab
        subroutine howfar ! in :egsfortran:tutor4_linux.f:electr:unknown_interface
        end subroutine howfar
    end interface electr_user_interface
end python module electr__user__routines
python module photon__user__routines
    interface photon_user_interface
        subroutine howfar ! in :egsfortran:tutor4_linux.f:photon:unknown_interface
        end subroutine howfar
    end interface photon_user_interface
end python module photon__user__routines
python module egsfortran ! in
    interface  ! in :egsfortran
        subroutine dummyxxx ! in :egsfortran:tutor4_linux.f
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 :: zbound
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(3) :: escore
            integer*4 :: iwatch
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            common /bounds/ ecut,pcut,vacdst
            common /geom/ zbound
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /score/ escore,iwatch
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end subroutine dummyxxx
        subroutine flush_output ! in :egsfortran:tutor4_linux.f
        end subroutine flush_output
        subroutine xxxhowfar ! in :egsfortran:tutor4_linux.f
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 :: zbound
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /geom/ zbound
        end subroutine xxxhowfar
        subroutine hownear(tperp,x,y,z,irl) ! in :egsfortran:tutor4_linux.f
            real*8 :: tperp
            real*8 :: x
            real*8 :: y
            real*8 :: z
            integer*4 :: irl
            real*8 :: zbound
            common /geom/ zbound
        end subroutine hownear
        subroutine xxxausgab(iarg) ! in :egsfortran:tutor4_linux.f
            integer*4 :: iarg
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(3) :: escore
            integer*4 :: iwatch
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /score/ escore,iwatch
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
        end subroutine xxxausgab
        subroutine ranlux(rng_array) ! in :egsfortran:tutor4_linux.f
            real*8 dimension(24) :: rng_array
            integer*4 :: seedin
            integer*4 :: luxury_level
            integer*4 dimension(25) :: state
            integer*4 :: ounit
            character*(*) :: fmt_flags
            entry init_ranlux(luxury_level,seedin)
            entry get_ranlux_state(state)
            entry set_ranlux_state(state)
            entry show_ranlux_seeds(ounit)
            entry print_ranlux_seeds(ounit,fmt_flags)
        end subroutine ranlux
        subroutine get_input ! in :egsfortran:tutor4_linux.f
            character dimension(100,6,64),intent(c) :: allowed_inputs
            character dimension(100,64),intent(c) :: values_sought
            character dimension(100,100,256),intent(c) :: char_value
            real*8 dimension(100,100) :: value
            real*8 dimension(100) :: default_bn
            real*8 dimension(100) :: value_min
            real*8 dimension(100) :: value_max
            integer*4 dimension(100) :: nvalue
            integer*4 dimension(100) :: type_bn
            integer*4 dimension(100) :: error_flags
            integer*4 :: i_errors
            integer*4 :: nmin
            integer*4 :: nmax
            integer*4 :: error_flag
            character*64 :: delimeter
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*4 :: the_level
            common /getinput/ allowed_inputs,values_sought,char_value,value,default_bn,value_min,value_max,nvalue,type_bn,error_flags,i_errors,nmin,nmax,error_flag,delimeter
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            entry get_input_set_error_level(the_level)
        end subroutine get_input
        subroutine get_transport_parameter(ounit) ! in :egsfortran:tutor4_linux.f
            integer*4 :: ounit
            character dimension(100,6,64),intent(c) :: allowed_inputs
            character dimension(100,64),intent(c) :: values_sought
            character dimension(100,100,256),intent(c) :: char_value
            real*8 dimension(100,100) :: value
            real*8 dimension(100) :: default_bn
            real*8 dimension(100) :: value_min
            real*8 dimension(100) :: value_max
            integer*4 dimension(100) :: nvalue
            integer*4 dimension(100) :: type_bn
            integer*4 dimension(100) :: error_flags
            integer*4 :: i_errors
            integer*4 :: nmin
            integer*4 :: nmax
            integer*4 :: error_flag
            character*64 :: delimeter
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(3) :: smaxir
            real*8 :: estepe
            real*8 :: ximax
            real*8 :: skindepth_for_bca
            integer*4 :: transport_algorithm
            integer*4 :: bca_algorithm
            logical :: exact_bca
            logical :: spin_effects
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            integer*4 dimension(1538) :: iz_array
            real*8 dimension(1538) :: be_array
            real*8 dimension(1538) :: jo_array
            real*8 dimension(1538) :: erfjo_array
            integer*4 dimension(1538) :: ne_array
            integer*4 dimension(1538) :: shn_array
            integer*4 dimension(200,1) :: shell_array
            real*8 dimension(200,1) :: eno_array
            integer*4 dimension(200,1) :: eno_atbin_array
            integer*4 dimension(1) :: n_shell
            integer*4 :: radc_flag
            integer*2 dimension(3) :: ibcmp
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(10000) :: eii_xsection_a
            real*8 dimension(10000) :: eii_xsection_b
            real*8 dimension(1) :: eii_cons
            real*8 dimension(40) :: eii_a
            real*8 dimension(40) :: eii_b
            real*8 :: eii_l_factor
            integer*4 dimension(40) :: eii_z
            integer*4 dimension(40) :: eii_sh
            integer*4 dimension(100) :: eii_nshells
            integer*4 dimension(1) :: eii_nsh
            integer*4 dimension(1,50) :: eii_first
            integer*4 dimension(1,50) :: eii_no
            integer*4 :: eii_flag
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            character dimension(1,24),intent(c) :: iray_ff_media
            character dimension(1,128),intent(c) :: iray_ff_file
            real*8 :: exin
            real*8 :: eyin
            real*8 :: ezin
            real*8 :: emlmtin
            real*8 :: bxin
            real*8 :: byin
            real*8 :: bzin
            real*8 :: bx
            real*8 :: by
            real*8 :: bz
            real*8 :: bx_new
            real*8 :: by_new
            real*8 :: bz_new
            logical :: emfield_on
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            common /getinput/ allowed_inputs,values_sought,char_value,value,default_bn,value_min,value_max,nvalue,type_bn,error_flags,i_errors,nmin,nmax,error_flag,delimeter
            common /bounds/ ecut,pcut,vacdst
            common /et_control/ smaxir,estepe,ximax,skindepth_for_bca,transport_algorithm,bca_algorithm,exact_bca,spin_effects
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /compton_data/ iz_array,be_array,jo_array,erfjo_array,ne_array,shn_array,shell_array,eno_array,eno_atbin_array,n_shell,radc_flag,ibcmp
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /eii_data/ eii_xsection_a,eii_xsection_b,eii_cons,eii_a,eii_b,eii_l_factor,eii_z,eii_sh,eii_nshells,eii_nsh,eii_first,eii_no,eii_flag
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /rayleigh_inputs/ iray_ff_media,iray_ff_file
            common /emf_inputs/ exin,eyin,ezin,emlmtin,bxin,byin,bzin,bx,by,bz,bx_new,by_new,bz_new,emfield_on
            common /x_options/ eadl_relax,mcdf_pe_xsections
            entry show_transport_parameter(ounit)
        end subroutine get_transport_parameter
        subroutine set_elastic_parameter ! in :egsfortran:tutor4_linux.f
            character dimension(100,6,64),intent(c) :: allowed_inputs
            character dimension(100,64),intent(c) :: values_sought
            character dimension(100,100,256),intent(c) :: char_value
            real*8 dimension(100,100) :: value
            real*8 dimension(100) :: default_bn
            real*8 dimension(100) :: value_min
            real*8 dimension(100) :: value_max
            integer*4 dimension(100) :: nvalue
            integer*4 dimension(100) :: type_bn
            integer*4 dimension(100) :: error_flags
            integer*4 :: i_errors
            integer*4 :: nmin
            integer*4 :: nmax
            integer*4 :: error_flag
            character*64 :: delimeter
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /getinput/ allowed_inputs,values_sought,char_value,value,default_bn,value_min,value_max,nvalue,type_bn,error_flags,i_errors,nmin,nmax,error_flag,delimeter
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine set_elastic_parameter
        subroutine watch(iarg,iwatch) ! in :egsfortran:tutor4_linux.f
            integer*4 :: iarg
            integer*4 :: iwatch
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            common /bounds/ ecut,pcut,vacdst
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end subroutine watch
        subroutine sigma(ndata,istat,mode,ierr) ! in :egsfortran:tutor4_linux.f
            integer*4 :: ndata
            integer*4 :: istat
            integer*4 :: mode
            integer*4 :: ierr
            real*8 dimension(1,2) :: data
            common /error/ data
        end subroutine sigma
        subroutine prepare_alias_sampling(nsbin,fs_array,ws_array,ibin_array) ! in :egsfortran:tutor4_linux.f
            integer*4, optional,check(len(fs_array)>=nsbin),depend(fs_array) :: nsbin=len(fs_array)
            real*8 dimension(nsbin) :: fs_array
            real*8 dimension(nsbin),depend(nsbin) :: ws_array
            integer*4 dimension(nsbin),depend(nsbin) :: ibin_array
        end subroutine prepare_alias_sampling
        function alias_sample(nsbin,xs_array,ws_array,ibin_array) ! in :egsfortran:tutor4_linux.f
            integer*4, optional,check((len(xs_array)-1)>=nsbin),depend(xs_array) :: nsbin=(len(xs_array)-1)
            real*8 dimension(nsbin + 1) :: xs_array
            real*8 dimension(nsbin),depend(nsbin) :: ws_array
            integer*4 dimension(nsbin),depend(nsbin) :: ibin_array
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 :: alias_sample
            common /randomm/ rng_array,seeds,rng_seed
        end function alias_sample
        function egs_system(command) ! in :egsfortran:tutor4_linux.f
            character*(*) :: command
            integer :: egs_system
        end function egs_system
        function egs_isdir(file_name) ! in :egsfortran:tutor4_linux.f
            character*(*) :: file_name
            logical :: egs_isdir
        end function egs_isdir
        subroutine egs_fdate(ounit) ! in :egsfortran:tutor4_linux.f
            integer :: ounit
        end subroutine egs_fdate
        subroutine egs_get_fdate(string_bn) ! in :egsfortran:tutor4_linux.f
            character*(*) :: string_bn
        end subroutine egs_get_fdate
        subroutine egs_date_and_time(vnow) ! in :egsfortran:tutor4_linux.f
            integer dimension(8) :: vnow
        end subroutine egs_date_and_time
        subroutine egs_date(ounit) ! in :egsfortran:tutor4_linux.f
            integer :: ounit
        end subroutine egs_date
        subroutine egs_time(ounit) ! in :egsfortran:tutor4_linux.f
            integer :: ounit
        end subroutine egs_time
        function egs_secnds(t0) ! in :egsfortran:tutor4_linux.f
            real :: t0
            real :: egs_secnds
        end function egs_secnds
        function egs_tot_time(flag) ! in :egsfortran:tutor4_linux.f
            integer :: flag
            real :: egs_tot_time
        end function egs_tot_time
        function egs_time_diff(vstart,vend) ! in :egsfortran:tutor4_linux.f
            integer dimension(8) :: vstart
            integer dimension(8) :: vend
            real :: egs_time_diff
        end function egs_time_diff
        function egs_day_diff(vstart,vend) ! in :egsfortran:tutor4_linux.f
            integer dimension(3) :: vstart
            integer dimension(3) :: vend
            integer :: egs_day_diff
        end function egs_day_diff
        subroutine egs_weekday(values,day) ! in :egsfortran:tutor4_linux.f
            integer dimension(3) :: values
            character*(*) :: day
        end subroutine egs_weekday
        function egs_day_diff_o(vstart,vend) ! in :egsfortran:tutor4_linux.f
            integer dimension(3) :: vstart
            integer dimension(3) :: vend
            integer :: egs_day_diff_o
        end function egs_day_diff_o
        function egs_time_diff_o(vstart,vend) ! in :egsfortran:tutor4_linux.f
            integer dimension(8) :: vstart
            integer dimension(8) :: vend
            real :: egs_time_diff_o
        end function egs_time_diff_o
        subroutine egs_month(mo,month) ! in :egsfortran:tutor4_linux.f
            integer :: mo
            character*(*) :: month
        end subroutine egs_month
        function egs_conver_month(month) ! in :egsfortran:tutor4_linux.f
            character*3 :: month
            integer :: egs_conver_month
        end function egs_conver_month
        function egs_etime() ! in :egsfortran:tutor4_linux.f
            real :: egs_etime
        end function egs_etime
        subroutine egs_print_canonical_system(ounit) ! in :egsfortran:tutor4_linux.f
            integer :: ounit
        end subroutine egs_print_canonical_system
        subroutine egs_get_canonical_system(res) ! in :egsfortran:tutor4_linux.f
            character*(*) :: res
        end subroutine egs_get_canonical_system
        subroutine egs_print_configuration_name(ounit) ! in :egsfortran:tutor4_linux.f
            integer :: ounit
        end subroutine egs_print_configuration_name
        subroutine egs_get_configuration_name(res) ! in :egsfortran:tutor4_linux.f
            character*(*) :: res
        end subroutine egs_get_configuration_name
        subroutine egs_print_hostnm(ounit) ! in :egsfortran:tutor4_linux.f
            integer :: ounit
        end subroutine egs_print_hostnm
        subroutine egs_get_hostnm(hname) ! in :egsfortran:tutor4_linux.f
            character*(*) :: hname
        end subroutine egs_get_hostnm
        subroutine egs_init ! in :egsfortran:tutor4_linux.f
            real*8 :: t_elapsed
            real*8 :: t_cpu
            integer dimension(8) :: t_first
            common /my_times/ t_elapsed,t_cpu,t_first
        end subroutine egs_init
        subroutine egs_init1 ! in :egsfortran:tutor4_linux.f
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 :: t_elapsed
            real*8 :: t_cpu
            integer dimension(8) :: t_first
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /my_times/ t_elapsed,t_cpu,t_first
        end subroutine egs_init1
        subroutine egs_check_arguments ! in :egsfortran:tutor4_linux.f
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_check_arguments
        subroutine egs_open_units(flag) ! in :egsfortran:tutor4_linux.f
            logical :: flag
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_open_units
        subroutine egs_finish ! in :egsfortran:tutor4_linux.f
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 :: t_elapsed
            real*8 :: t_cpu
            integer dimension(8) :: t_first
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /my_times/ t_elapsed,t_cpu,t_first
        end subroutine egs_finish
        subroutine egs_set_defaults ! in :egsfortran:tutor4_linux.f
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            integer*4 dimension(1538) :: iz_array
            real*8 dimension(1538) :: be_array
            real*8 dimension(1538) :: jo_array
            real*8 dimension(1538) :: erfjo_array
            integer*4 dimension(1538) :: ne_array
            integer*4 dimension(1538) :: shn_array
            integer*4 dimension(200,1) :: shell_array
            real*8 dimension(200,1) :: eno_array
            integer*4 dimension(200,1) :: eno_atbin_array
            integer*4 dimension(1) :: n_shell
            integer*4 :: radc_flag
            integer*2 dimension(3) :: ibcmp
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 :: count_pii_steps
            real*8 :: count_all_steps
            logical :: is_ch_step
            real*8 dimension(3) :: smaxir
            real*8 :: estepe
            real*8 :: ximax
            real*8 :: skindepth_for_bca
            integer*4 :: transport_algorithm
            integer*4 :: bca_algorithm
            logical :: exact_bca
            logical :: spin_effects
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: sinc0
            real*8 :: sinc1
            real*8 dimension(1002) :: sin0
            real*8 dimension(1002) :: sin1
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*4 dimension(1,2,32,16,32) :: spin_rej
            real*4 :: espin_min
            real*4 :: espin_max
            real*4 :: espml
            real*4 :: b2spin_min
            real*4 :: b2spin_max
            real*4 :: dbeta2
            real*4 :: dbeta2i
            real*4 :: dlener
            real*4 :: dleneri
            real*4 :: dqq1
            real*4 :: dqq1i
            logical, optional :: fool_intel_optimizer=.false.
            real*8 dimension(10000) :: eii_xsection_a
            real*8 dimension(10000) :: eii_xsection_b
            real*8 dimension(1) :: eii_cons
            real*8 dimension(40) :: eii_a
            real*8 dimension(40) :: eii_b
            real*8 :: eii_l_factor
            integer*4 dimension(40) :: eii_z
            integer*4 dimension(40) :: eii_sh
            integer*4 dimension(100) :: eii_nshells
            integer*4 dimension(1) :: eii_nsh
            integer*4 dimension(1,50) :: eii_first
            integer*4 dimension(1,50) :: eii_no
            integer*4 :: eii_flag
            character dimension(1,24),intent(c) :: iray_ff_media
            character dimension(1,128),intent(c) :: iray_ff_file
            real*8 :: exin
            real*8 :: eyin
            real*8 :: ezin
            real*8 :: emlmtin
            real*8 :: bxin
            real*8 :: byin
            real*8 :: bzin
            real*8 :: bx
            real*8 :: by
            real*8 :: bz
            real*8 :: bx_new
            real*8 :: by_new
            real*8 :: bz_new
            logical :: emfield_on
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            common /bounds/ ecut,pcut,vacdst
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /compton_data/ iz_array,be_array,jo_array,erfjo_array,ne_array,shn_array,shell_array,eno_array,eno_atbin_array,n_shell,radc_flag,ibcmp
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /ch_steps/ count_pii_steps,count_all_steps,is_ch_step
            common /et_control/ smaxir,estepe,ximax,skindepth_for_bca,transport_algorithm,bca_algorithm,exact_bca,spin_effects
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /randomm/ rng_array,seeds,rng_seed
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiin/ sinc0,sinc1,sin0,sin1
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /spin_data/ spin_rej,espin_min,espin_max,espml,b2spin_min,b2spin_max,dbeta2,dbeta2i,dlener,dleneri,dqq1,dqq1i,fool_intel_optimizer
            common /eii_data/ eii_xsection_a,eii_xsection_b,eii_cons,eii_a,eii_b,eii_l_factor,eii_z,eii_sh,eii_nshells,eii_nsh,eii_first,eii_no,eii_flag
            common /rayleigh_inputs/ iray_ff_media,iray_ff_file
            common /emf_inputs/ exin,eyin,ezin,emlmtin,bxin,byin,bzin,bx,by,bz,bx_new,by_new,bz_new,emfield_on
            common /x_options/ eadl_relax,mcdf_pe_xsections
        end subroutine egs_set_defaults
        subroutine egs_combine_runs(combine_routine,extension) ! in :egsfortran:tutor4_linux.f
            use egs_combine_runs__user__routines
            external combine_routine
            character*(*) :: extension
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_combine_runs
        function egs_strip_extension(filen,fext) ! in :egsfortran:tutor4_linux.f
            character*(*) :: filen
            character*(*) :: fext
            logical :: egs_strip_extension
        end function egs_strip_extension
        function egs_is_absolute_path(fn) ! in :egsfortran:tutor4_linux.f
            character*(*) :: fn
            logical :: egs_is_absolute_path
        end function egs_is_absolute_path
        function egs_get_unit(iunit) ! in :egsfortran:tutor4_linux.f
            integer*4 :: iunit
            integer :: egs_get_unit
        end function egs_get_unit
        function egs_open_file(iunit,rl,action,extension) ! in :egsfortran:tutor4_linux.f
            integer*4 :: iunit
            integer*4 :: rl
            integer*4 :: action
            character*(*) :: extension
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer :: egs_open_file
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end function egs_open_file
        function egs_open_datfile(iunit,rl,action,extension) ! in :egsfortran:tutor4_linux.f
            integer*4 :: iunit
            integer*4 :: rl
            integer*4 :: action
            character*(*) :: extension
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer :: egs_open_datfile
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end function egs_open_datfile
        function egs_open_file_junk(iunit,do_it_anyway,filen) ! in :egsfortran:tutor4_linux.f
            integer*4 :: iunit
            logical :: do_it_anyway
            character*(*) :: filen
            integer :: egs_open_file_junk
        end function egs_open_file_junk
        subroutine egs_strip_path(fname) ! in :egsfortran:tutor4_linux.f
            character*(*) :: fname
        end subroutine egs_strip_path
        subroutine replace_env(fname) ! in :egsfortran:tutor4_linux.f
            character*(*) :: fname
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine replace_env
        subroutine egs_get_usercode(ucode) ! in :egsfortran:tutor4_linux.f
            character*(*) :: ucode
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_get_usercode
        subroutine egs_itostring(string_bn,i,leave_space) ! in :egsfortran:tutor4_linux.f
            character*(*) :: string_bn
            integer*4 :: i
            logical :: leave_space
        end subroutine egs_itostring
        function egs_rndm() ! in :egsfortran:tutor4_linux.f
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 :: egs_rndm
            common /randomm/ rng_array,seeds,rng_seed
        end function egs_rndm
        function egs_add_medium(medname) ! in :egsfortran:tutor4_linux.f
            character*(*) :: medname
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer :: egs_add_medium
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end function egs_add_medium
        subroutine egs_get_medium_name(imed,medname) ! in :egsfortran:tutor4_linux.f
            integer*4 :: imed
            character*(*) :: medname
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_get_medium_name
        subroutine egs_get_electron_data(func,imed,which) ! in :egsfortran:tutor4_linux.f
            use egs_get_electron_data__user__routines
            external func
            integer*4 :: imed
            integer*4 :: which
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_get_electron_data
        subroutine egs_get_photon_data(func,imed,which) ! in :egsfortran:tutor4_linux.f
            use egs_get_photon_data__user__routines
            external func
            integer*4 :: imed
            integer*4 :: which
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_get_photon_data
        subroutine egs_print_binding_energies ! in :egsfortran:tutor4_linux.f
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_print_binding_energies
        subroutine egs_scale_xcc(imed,factor) ! in :egsfortran:tutor4_linux.f
            integer*4 :: imed
            real*8 :: factor
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
        end subroutine egs_scale_xcc
        subroutine egs_write_string(ounit,string_bn) ! in :egsfortran:tutor4_linux.f
            integer*4 :: ounit
            character*(*) :: string_bn
        end subroutine egs_write_string
        subroutine egs_swap_2(c) ! in :egsfortran:tutor4_linux.f
            character dimension(2) :: c
        end subroutine egs_swap_2
        subroutine egs_swap_4(c) ! in :egsfortran:tutor4_linux.f
            character dimension(4) :: c
        end subroutine egs_swap_4
        subroutine set_spline(x,f,a,b,c,d,n) ! in :egsfortran:tutor4_linux.f
            real*8 dimension(n) :: x
            real*8 dimension(n),depend(n) :: f
            real*8 dimension(n),depend(n) :: a
            real*8 dimension(n),depend(n) :: b
            real*8 dimension(n),depend(n) :: c
            real*8 dimension(n),depend(n) :: d
            integer*4, optional,check(len(x)>=n),depend(x) :: n=len(x)
        end subroutine set_spline
        function spline(s,x,a,b,c,d,n) ! in :egsfortran:tutor4_linux.f
            real*8 :: s
            real*8 dimension(n) :: x
            real*8 dimension(n),depend(n) :: a
            real*8 dimension(n),depend(n) :: b
            real*8 dimension(n),depend(n) :: c
            real*8 dimension(n),depend(n) :: d
            integer*4, optional,check(len(x)>=n),depend(x) :: n=len(x)
            real*8 :: spline
        end function spline
        subroutine prepare_alias_table(nsbin,xs_array,fs_array,ws_array,ibin_array) ! in :egsfortran:tutor4_linux.f
            integer, optional,check((len(xs_array)-1)>=nsbin),depend(xs_array) :: nsbin=(len(xs_array)-1)
            real*8 dimension(nsbin + 1) :: xs_array
            real*8 dimension(nsbin + 1),depend(nsbin) :: fs_array
            real*8 dimension(nsbin),depend(nsbin) :: ws_array
            integer*4 dimension(nsbin),depend(nsbin) :: ibin_array
        end subroutine prepare_alias_table
        function alias_sample1(nsbin,xs_array,fs_array,ws_array,ibin_array) ! in :egsfortran:tutor4_linux.f
            integer, optional,check((len(xs_array)-1)>=nsbin),depend(xs_array) :: nsbin=(len(xs_array)-1)
            real*8 dimension(nsbin + 1) :: xs_array
            real*8 dimension(nsbin + 1),depend(nsbin) :: fs_array
            real*8 dimension(nsbin),depend(nsbin) :: ws_array
            integer*4 dimension(nsbin),depend(nsbin) :: ibin_array
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 :: alias_sample1
            common /randomm/ rng_array,seeds,rng_seed
        end function alias_sample1
        subroutine prepare_alias_histogram(nsbin,ws_array,ibin_array) ! in :egsfortran:tutor4_linux.f
            integer*4, optional,check(len(ws_array)>=nsbin),depend(ws_array) :: nsbin=len(ws_array)
            real*8 dimension(nsbin) :: ws_array
            integer*4 dimension(nsbin),depend(nsbin) :: ibin_array
        end subroutine prepare_alias_histogram
        function sample_alias_histogram(nsbin,ws_array,ibin_array) ! in :egsfortran:tutor4_linux.f
            integer*4 :: nsbin
            real*8 dimension(*) :: ws_array
            integer*4 dimension(*) :: ibin_array
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            integer*4 :: sample_alias_histogram
            common /randomm/ rng_array,seeds,rng_seed
        end function sample_alias_histogram
        subroutine gauss_legendre(x1,x2,x,w,n) ! in :egsfortran:tutor4_linux.f
            real*8 :: x1
            real*8 :: x2
            real*8 dimension(n) :: x
            real*8 dimension(n),depend(n) :: w
            integer*4, optional,check(len(x)>=n),depend(x) :: n=len(x)
        end subroutine gauss_legendre
        function lnblnk1(string_bn) ! in :egsfortran:tutor4_linux.f
            character*(*) :: string_bn
            integer :: lnblnk1
        end function lnblnk1
        function erf1(x) ! in :egsfortran:tutor4_linux.f
            real*8 :: x
            real*8 :: erf1
        end function erf1
        function zero() ! in :egsfortran:tutor4_linux.f
            real*8 :: zero
        end function zero
        function toupper(a_string) ! in :egsfortran:tutor4_linux.f
            character*(*) :: a_string
            character*512 :: toupper
        end function toupper
        function egs_read_byte(iunit,jrec) ! in :egsfortran:tutor4_linux.f
            integer :: iunit
            integer :: jrec
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*1 :: egs_read_byte
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end function egs_read_byte
        function egs_read_short(iunit,jrec) ! in :egsfortran:tutor4_linux.f
            integer :: iunit
            integer :: jrec
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*2 :: egs_read_short
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end function egs_read_short
        function egs_read_int(iunit,jrec) ! in :egsfortran:tutor4_linux.f
            integer :: iunit
            integer :: jrec
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*4 :: egs_read_int
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end function egs_read_int
        function egs_read_real(iunit,jrec) ! in :egsfortran:tutor4_linux.f
            integer :: iunit
            integer :: jrec
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*4 :: egs_read_real
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end function egs_read_real
        function ibsearch(a,nsh,b) ! in :egsfortran:tutor4_linux.f
            real*8 :: a
            integer*4 :: nsh
            real*8 dimension(*) :: b
            integer*4 :: ibsearch
        end function ibsearch
        subroutine annih ! in :egsfortran:tutor4_linux.f
            logical :: qdebug
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /qdebug/ qdebug
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine annih
        subroutine annih_at_rest ! in :egsfortran:tutor4_linux.f
            logical :: qdebug
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /qdebug/ qdebug
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /randomm/ rng_array,seeds,rng_seed
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine annih_at_rest
        subroutine bhabha ! in :egsfortran:tutor4_linux.f
            logical :: qdebug
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /qdebug/ qdebug
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine bhabha
        subroutine brems ! in :egsfortran:tutor4_linux.f
            logical :: qdebug
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(51,100,1) :: nb_fdata
            real*8 dimension(51,100,1) :: nb_xdata
            real*8 dimension(50,100,1) :: nb_wdata
            integer*4 dimension(50,100,1) :: nb_idata
            real*8 dimension(1) :: nb_emin
            real*8 dimension(1) :: nb_emax
            real*8 dimension(1) :: nb_lemin
            real*8 dimension(1) :: nb_lemax
            real*8 dimension(1) :: nb_dle
            real*8 dimension(1) :: nb_dlei
            real*8 dimension(1) :: log_ap
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /qdebug/ qdebug
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /nist_brems/ nb_fdata,nb_xdata,nb_wdata,nb_idata,nb_emin,nb_emax,nb_lemin,nb_lemax,nb_dle,nb_dlei,log_ap
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine brems
        subroutine compt ! in :egsfortran:tutor4_linux.f
            integer*4 dimension(1538) :: iz_array
            real*8 dimension(1538) :: be_array
            real*8 dimension(1538) :: jo_array
            real*8 dimension(1538) :: erfjo_array
            integer*4 dimension(1538) :: ne_array
            integer*4 dimension(1538) :: shn_array
            integer*4 dimension(200,1) :: shell_array
            real*8 dimension(200,1) :: eno_array
            integer*4 dimension(200,1) :: eno_atbin_array
            integer*4 dimension(1) :: n_shell
            integer*4 :: radc_flag
            integer*2 dimension(3) :: ibcmp
            logical :: qdebug
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            common /compton_data/ iz_array,be_array,jo_array,erfjo_array,ne_array,shn_array,shell_array,eno_array,eno_atbin_array,n_shell,radc_flag,ibcmp
            common /qdebug/ qdebug
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
        end subroutine compt
        subroutine old_compt ! in :egsfortran:tutor4_linux.f
            integer*4 dimension(1538) :: iz_array
            real*8 dimension(1538) :: be_array
            real*8 dimension(1538) :: jo_array
            real*8 dimension(1538) :: erfjo_array
            integer*4 dimension(1538) :: ne_array
            integer*4 dimension(1538) :: shn_array
            integer*4 dimension(200,1) :: shell_array
            real*8 dimension(200,1) :: eno_array
            integer*4 dimension(200,1) :: eno_atbin_array
            integer*4 dimension(1) :: n_shell
            integer*4 :: radc_flag
            integer*2 dimension(3) :: ibcmp
            logical :: qdebug
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            common /compton_data/ iz_array,be_array,jo_array,erfjo_array,ne_array,shn_array,shell_array,eno_array,eno_atbin_array,n_shell,radc_flag,ibcmp
            common /qdebug/ qdebug
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
        end subroutine old_compt
        subroutine electr(ircode,howfar) ! in :egsfortran:tutor4_linux.f
            use electr__user__routines
            integer*4 :: ircode
            external howfar
            logical :: qdebug
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: sinc0
            real*8 :: sinc1
            real*8 dimension(1002) :: sin0
            real*8 dimension(1002) :: sin1
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: smaxir
            real*8 :: estepe
            real*8 :: ximax
            real*8 :: skindepth_for_bca
            integer*4 :: transport_algorithm
            integer*4 :: bca_algorithm
            logical :: exact_bca
            logical :: spin_effects
            real*8 :: count_pii_steps
            real*8 :: count_all_steps
            logical :: is_ch_step
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            real*8 :: exin
            real*8 :: eyin
            real*8 :: ezin
            real*8 :: emlmtin
            real*8 :: bxin
            real*8 :: byin
            real*8 :: bzin
            real*8 :: bx
            real*8 :: by
            real*8 :: bz
            real*8 :: bx_new
            real*8 :: by_new
            real*8 :: bz_new
            logical :: emfield_on
            real*8 dimension(10000) :: eii_xsection_a
            real*8 dimension(10000) :: eii_xsection_b
            real*8 dimension(1) :: eii_cons
            real*8 dimension(40) :: eii_a
            real*8 dimension(40) :: eii_b
            real*8 :: eii_l_factor
            integer*4 dimension(40) :: eii_z
            integer*4 dimension(40) :: eii_sh
            integer*4 dimension(100) :: eii_nshells
            integer*4 dimension(1) :: eii_nsh
            integer*4 dimension(1,50) :: eii_first
            integer*4 dimension(1,50) :: eii_no
            integer*4 :: eii_flag
            intent(callback,hide) ausgab
            external ausgab
            common /qdebug/ qdebug
            common /bounds/ ecut,pcut,vacdst
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiin/ sinc0,sinc1,sin0,sin1
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /et_control/ smaxir,estepe,ximax,skindepth_for_bca,transport_algorithm,bca_algorithm,exact_bca,spin_effects
            common /ch_steps/ count_pii_steps,count_all_steps,is_ch_step
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /emf_inputs/ exin,eyin,ezin,emlmtin,bxin,byin,bzin,bx,by,bz,bx_new,by_new,bz_new,emfield_on
            common /eii_data/ eii_xsection_a,eii_xsection_b,eii_cons,eii_a,eii_b,eii_l_factor,eii_z,eii_sh,eii_nshells,eii_nsh,eii_first,eii_no,eii_flag
        end subroutine electr
        subroutine hatch ! in :egsfortran:tutor4_linux.f
            logical :: qdebug
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: sinc0
            real*8 :: sinc1
            real*8 dimension(1002) :: sin0
            real*8 dimension(1002) :: sin1
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: smaxir
            real*8 :: estepe
            real*8 :: ximax
            real*8 :: skindepth_for_bca
            integer*4 :: transport_algorithm
            integer*4 :: bca_algorithm
            logical :: exact_bca
            logical :: spin_effects
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            common /qdebug/ qdebug
            common /bounds/ ecut,pcut,vacdst
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiin/ sinc0,sinc1,sin0,sin1
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /et_control/ smaxir,estepe,ximax,skindepth_for_bca,transport_algorithm,bca_algorithm,exact_bca,spin_effects
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
        end subroutine hatch
        subroutine fix_brems ! in :egsfortran:tutor4_linux.f
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(51,100,1) :: nb_fdata
            real*8 dimension(51,100,1) :: nb_xdata
            real*8 dimension(50,100,1) :: nb_wdata
            integer*4 dimension(50,100,1) :: nb_idata
            real*8 dimension(1) :: nb_emin
            real*8 dimension(1) :: nb_emax
            real*8 dimension(1) :: nb_lemin
            real*8 dimension(1) :: nb_lemax
            real*8 dimension(1) :: nb_dle
            real*8 dimension(1) :: nb_dlei
            real*8 dimension(1) :: log_ap
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /nist_brems/ nb_fdata,nb_xdata,nb_wdata,nb_idata,nb_emin,nb_emax,nb_lemin,nb_lemax,nb_dle,nb_dlei,log_ap
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
        end subroutine fix_brems
        function fcoulc(z) ! in :egsfortran:tutor4_linux.f
            real*8 :: z
            real*8 :: fcoulc
        end function fcoulc
        function xsif(z) ! in :egsfortran:tutor4_linux.f
            real*8 :: z
            real*8 :: xsif
        end function xsif
        subroutine init_compton ! in :egsfortran:tutor4_linux.f
            integer*4 dimension(1538) :: iz_array
            real*8 dimension(1538) :: be_array
            real*8 dimension(1538) :: jo_array
            real*8 dimension(1538) :: erfjo_array
            integer*4 dimension(1538) :: ne_array
            integer*4 dimension(1538) :: shn_array
            integer*4 dimension(200,1) :: shell_array
            real*8 dimension(200,1) :: eno_array
            integer*4 dimension(200,1) :: eno_atbin_array
            integer*4 dimension(1) :: n_shell
            integer*4 :: radc_flag
            integer*2 dimension(3) :: ibcmp
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            common /compton_data/ iz_array,be_array,jo_array,erfjo_array,ne_array,shn_array,shell_array,eno_array,eno_atbin_array,n_shell,radc_flag,ibcmp
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /x_options/ eadl_relax,mcdf_pe_xsections
        end subroutine init_compton
        subroutine moller ! in :egsfortran:tutor4_linux.f
            logical :: qdebug
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            real*8 dimension(10000) :: eii_xsection_a
            real*8 dimension(10000) :: eii_xsection_b
            real*8 dimension(1) :: eii_cons
            real*8 dimension(40) :: eii_a
            real*8 dimension(40) :: eii_b
            real*8 :: eii_l_factor
            integer*4 dimension(40) :: eii_z
            integer*4 dimension(40) :: eii_sh
            integer*4 dimension(100) :: eii_nshells
            integer*4 dimension(1) :: eii_nsh
            integer*4 dimension(1,50) :: eii_first
            integer*4 dimension(1,50) :: eii_no
            integer*4 :: eii_flag
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            common /qdebug/ qdebug
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /eii_data/ eii_xsection_a,eii_xsection_b,eii_cons,eii_a,eii_b,eii_l_factor,eii_z,eii_sh,eii_nshells,eii_nsh,eii_first,eii_no,eii_flag
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
        end subroutine moller
        subroutine mscati ! in :egsfortran:tutor4_linux.f
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: smaxir
            real*8 :: estepe
            real*8 :: ximax
            real*8 :: skindepth_for_bca
            integer*4 :: transport_algorithm
            integer*4 :: bca_algorithm
            logical :: exact_bca
            logical :: spin_effects
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /bounds/ ecut,pcut,vacdst
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /randomm/ rng_array,seeds,rng_seed
            common /et_control/ smaxir,estepe,ximax,skindepth_for_bca,transport_algorithm,bca_algorithm,exact_bca,spin_effects
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine mscati
        subroutine mscat(lambda,chia2,q1,elke,beta2,qel,medium,spin_effects,find_index,spin_index,cost,sint) ! in :egsfortran:tutor4_linux.f
            real*8 :: lambda
            real*8 :: chia2
            real*8 :: q1
            real*8 :: elke
            real*8 :: beta2
            integer*4 :: qel
            integer*4 :: medium
            logical :: spin_effects
            logical :: find_index
            logical :: spin_index
            real*8 :: cost
            real*8 :: sint
            real*4 dimension(64,8,32) :: ums_array
            real*4 dimension(64,8,32) :: fms_array
            real*4 dimension(64,8,32) :: wms_array
            integer*2 dimension(64,8,32) :: ims_array
            real*4 :: llammin
            real*4 :: llammax
            real*4 :: dllamb
            real*4 :: dllambi
            real*4 :: dqms
            real*4 :: dqmsi
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /ms_data/ ums_array,fms_array,wms_array,ims_array,llammin,llammax,dllamb,dllambi,dqms,dqmsi
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine mscat
        function spin_rejection(qel,medium,elke,beta2,q1,cost,spin_index,is_single) ! in :egsfortran:tutor4_linux.f
            integer*4 :: qel
            integer*4 :: medium
            real*8 :: elke
            real*8 :: beta2
            real*8 :: q1
            real*8 :: cost
            logical :: spin_index
            logical :: is_single
            real*4 dimension(1,2,32,16,32) :: spin_rej
            real*4 :: espin_min
            real*4 :: espin_max
            real*4 :: espml
            real*4 :: b2spin_min
            real*4 :: b2spin_max
            real*4 :: dbeta2
            real*4 :: dbeta2i
            real*4 :: dlener
            real*4 :: dleneri
            real*4 :: dqq1
            real*4 :: dqq1i
            logical :: fool_intel_optimizer
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 :: spin_rejection
            common /spin_data/ spin_rej,espin_min,espin_max,espml,b2spin_min,b2spin_max,dbeta2,dbeta2i,dlener,dleneri,dqq1,dqq1i,fool_intel_optimizer
            common /randomm/ rng_array,seeds,rng_seed
        end function spin_rejection
        subroutine sscat(chia2,elke,beta2,qel,medium,spin_effects,cost,sint) ! in :egsfortran:tutor4_linux.f
            real*8 :: chia2
            real*8 :: elke
            real*8 :: beta2
            integer*4 :: qel
            integer*4 :: medium
            logical :: spin_effects
            real*8 intent(inout) :: cost
            real*8 intent(inout) :: sint
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine sscat
        subroutine init_ms_sr ! in :egsfortran:tutor4_linux.f
            real*4 dimension(64,8,32) :: ums_array
            real*4 dimension(64,8,32) :: fms_array
            real*4 dimension(64,8,32) :: wms_array
            integer*2 dimension(64,8,32) :: ims_array
            real*4 :: llammin
            real*4 :: llammax
            real*4 :: dllamb
            real*4 :: dllambi
            real*4 :: dqms
            real*4 :: dqmsi
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /ms_data/ ums_array,fms_array,wms_array,ims_array,llammin,llammax,dllamb,dllambi,dqms,dqmsi
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine init_ms_sr
        subroutine init_spin ! in :egsfortran:tutor4_linux.f
            real*4 dimension(1,2,32,16,32) :: spin_rej
            real*4 :: espin_min
            real*4 :: espin_max
            real*4 :: espml
            real*4 :: b2spin_min
            real*4 :: b2spin_max
            real*4 :: dbeta2
            real*4 :: dbeta2i
            real*4 :: dlener
            real*4 :: dleneri
            real*4 :: dqq1
            real*4 :: dqq1i
            logical :: fool_intel_optimizer
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /spin_data/ spin_rej,espin_min,espin_max,espml,b2spin_min,b2spin_max,dbeta2,dbeta2i,dlener,dleneri,dqq1,dqq1i,fool_intel_optimizer
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine init_spin
        subroutine init_spin_old ! in :egsfortran:tutor4_linux.f
            real*4 dimension(1,2,32,16,32) :: spin_rej
            real*4 :: espin_min
            real*4 :: espin_max
            real*4 :: espml
            real*4 :: b2spin_min
            real*4 :: b2spin_max
            real*4 :: dbeta2
            real*4 :: dbeta2i
            real*4 :: dlener
            real*4 :: dleneri
            real*4 :: dqq1
            real*4 :: dqq1i
            logical :: fool_intel_optimizer
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /spin_data/ spin_rej,espin_min,espin_max,espml,b2spin_min,b2spin_max,dbeta2,dbeta2i,dlener,dleneri,dqq1,dqq1i,fool_intel_optimizer
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine init_spin_old
        subroutine msdist_pii(e0,eloss,tustep,rhof,med,qel,spin_effects,u0,v0,w0,x0,y0,z0,us,vs,ws,xf,yf,zf,ustep) ! in :egsfortran:tutor4_linux.f
            real*8 :: e0
            real*8 :: eloss
            real*8 :: tustep
            real*8 :: rhof
            integer*4 :: med
            integer*4 :: qel
            logical :: spin_effects
            real*8 :: u0
            real*8 :: v0
            real*8 :: w0
            real*8 :: x0
            real*8 :: y0
            real*8 :: z0
            real*8 intent(inout) :: us
            real*8 intent(inout) :: vs
            real*8 intent(inout) :: ws
            real*8 intent(inout) :: xf
            real*8 intent(inout) :: yf
            real*8 intent(inout) :: zf
            real*8 intent(inout) :: ustep
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 :: count_pii_steps
            real*8 :: count_all_steps
            logical :: is_ch_step
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 :: exin
            real*8 :: eyin
            real*8 :: ezin
            real*8 :: emlmtin
            real*8 :: bxin
            real*8 :: byin
            real*8 :: bzin
            real*8 :: bx
            real*8 :: by
            real*8 :: bz
            real*8 :: bx_new
            real*8 :: by_new
            real*8 :: bz_new
            logical :: emfield_on
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /randomm/ rng_array,seeds,rng_seed
            common /ch_steps/ count_pii_steps,count_all_steps,is_ch_step
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /emf_inputs/ exin,eyin,ezin,emlmtin,bxin,byin,bzin,bx,by,bz,bx_new,by_new,bz_new,emfield_on
        end subroutine msdist_pii
        subroutine msdist_pi(e0,eloss,tustep,rhof,medium,qel,spin_effects,u0,v0,w0,x0,y0,z0,us,vs,ws,xf,yf,zf,ustep) ! in :egsfortran:tutor4_linux.f
            real*8 :: e0
            real*8 :: eloss
            real*8 :: tustep
            real*8 :: rhof
            integer*4 :: medium
            integer*4 :: qel
            logical :: spin_effects
            real*8 :: u0
            real*8 :: v0
            real*8 :: w0
            real*8 :: x0
            real*8 :: y0
            real*8 :: z0
            real*8 intent(inout) :: us
            real*8 intent(inout) :: vs
            real*8 intent(inout) :: ws
            real*8 intent(inout) :: xf
            real*8 intent(inout) :: yf
            real*8 intent(inout) :: zf
            real*8 intent(inout) :: ustep
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 :: exin
            real*8 :: eyin
            real*8 :: ezin
            real*8 :: emlmtin
            real*8 :: bxin
            real*8 :: byin
            real*8 :: bzin
            real*8 :: bx
            real*8 :: by
            real*8 :: bz
            real*8 :: bx_new
            real*8 :: by_new
            real*8 :: bz_new
            logical :: emfield_on
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /randomm/ rng_array,seeds,rng_seed
            common /emf_inputs/ exin,eyin,ezin,emlmtin,bxin,byin,bzin,bx,by,bz,bx_new,by_new,bz_new,emfield_on
        end subroutine msdist_pi
        subroutine pair ! in :egsfortran:tutor4_linux.f
            logical :: qdebug
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(65,84,1) :: nrcp_fdata
            real*8 dimension(65,84,1) :: nrcp_wdata
            integer*4 dimension(65,84,1) :: nrcp_idata
            real*8 dimension(65) :: nrcp_xdata
            real*8 :: nrcp_emin
            real*8 :: nrcp_emax
            real*8 :: nrcp_dle
            real*8 :: nrcp_dlei
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(250,1) :: a_triplet
            real*8 dimension(250,1) :: b_triplet
            real*8 :: dl_triplet
            real*8 :: dli_triplet
            real*8 :: bli_triplet
            real*8 :: log_4rm
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /qdebug/ qdebug
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /nrc_pair/ nrcp_fdata,nrcp_wdata,nrcp_idata,nrcp_xdata,nrcp_emin,nrcp_emax,nrcp_dle,nrcp_dlei
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /triplet_data/ a_triplet,b_triplet,dl_triplet,dli_triplet,bli_triplet,log_4rm
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine pair
        subroutine sample_triplet ! in :egsfortran:tutor4_linux.f
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine sample_triplet
        subroutine photo ! in :egsfortran:tutor4_linux.f
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            logical :: qdebug
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            common /bounds/ ecut,pcut,vacdst
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /qdebug/ qdebug
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /randomm/ rng_array,seeds,rng_seed
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
        end subroutine photo
        subroutine egs_shellwise_photo ! in :egsfortran:tutor4_linux.f
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            logical :: qdebug
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            real*8 dimension(500,100,17) :: pe_xsection
            real*8 dimension(500,100,1) :: pe_elem_prob
            real*8 dimension(500,100) :: pe_energy
            integer*4 dimension(100,1) :: pe_zsorted
            real*8 dimension(100,16) :: pe_be
            integer*4 dimension(100) :: pe_nshell
            integer*4 dimension(100) :: pe_zpos
            integer*4 dimension(100) :: pe_nge
            integer*4 :: pe_ne
            common /bounds/ ecut,pcut,vacdst
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /qdebug/ qdebug
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /randomm/ rng_array,seeds,rng_seed
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
            common /pe_shell_data/ pe_xsection,pe_elem_prob,pe_energy,pe_zsorted,pe_be,pe_nshell,pe_zpos,pe_nge,pe_ne
        end subroutine egs_shellwise_photo
        subroutine egs_read_shellwise_pe ! in :egsfortran:tutor4_linux.f
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(500,100,17) :: pe_xsection
            real*8 dimension(500,100,1) :: pe_elem_prob
            real*8 dimension(500,100) :: pe_energy
            integer*4 dimension(100,1) :: pe_zsorted
            real*8 dimension(100,16) :: pe_be
            integer*4 dimension(100) :: pe_nshell
            integer*4 dimension(100) :: pe_zpos
            integer*4 dimension(100) :: pe_nge
            integer*4 :: pe_ne
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /pe_shell_data/ pe_xsection,pe_elem_prob,pe_energy,pe_zsorted,pe_be,pe_nshell,pe_zpos,pe_nge,pe_ne
        end subroutine egs_read_shellwise_pe
        subroutine relax(energy,n,iz) ! in :egsfortran:tutor4_linux.f
            real*8 :: energy
            integer*4 :: n
            integer*4 :: iz
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            real*8 :: u_relax
            integer*4 :: ish_relax
            integer*4 :: iz_relax
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /bounds/ ecut,pcut,vacdst
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /user_relax/ u_relax,ish_relax,iz_relax
        end subroutine relax
        subroutine egs_init_relax ! in :egsfortran:tutor4_linux.f
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            real*8 dimension(3000) :: shell_be
            integer*4 dimension(3000) :: shell_type
            integer*4 dimension(3000) :: shell_num
            integer*4 dimension(3000) :: shell_z
            integer*4 dimension(100,30) :: shell_eadl
            integer*4 :: shell_ntot
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
            common /shell_data/ shell_be,shell_type,shell_num,shell_z,shell_eadl,shell_ntot
        end subroutine egs_init_relax
        subroutine egs_eadl_relax(iz,shell_egs) ! in :egsfortran:tutor4_linux.f
            integer*4 :: iz
            integer*4 :: shell_egs
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            real*8 :: rfu_e0
            real*8 :: rfu_e
            integer*4 :: rfu_z
            integer*4 :: rfu_j0
            integer*4 :: rfu_n0
            integer*4 :: rfu_t0
            integer*4 :: rfu_j
            integer*4 :: rfu_n
            integer*4 :: rfu_t
            real*8 dimension(3000) :: shell_be
            integer*4 dimension(3000) :: shell_type
            integer*4 dimension(3000) :: shell_num
            integer*4 dimension(3000) :: shell_z
            integer*4 dimension(100,30) :: shell_eadl
            integer*4 :: shell_ntot
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            real*8 :: u_relax
            integer*4 :: ish_relax
            integer*4 :: iz_relax
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
            common /relax_for_user/ rfu_e0,rfu_e,rfu_z,rfu_j0,rfu_n0,rfu_t0,rfu_j,rfu_n,rfu_t
            common /shell_data/ shell_be,shell_type,shell_num,shell_z,shell_eadl,shell_ntot
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /randomm/ rng_array,seeds,rng_seed
            common /bounds/ ecut,pcut,vacdst
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /user_relax/ u_relax,ish_relax,iz_relax
        end subroutine egs_eadl_relax
        subroutine init_triplet ! in :egsfortran:tutor4_linux.f
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(250,1) :: a_triplet
            real*8 dimension(250,1) :: b_triplet
            real*8 :: dl_triplet
            real*8 :: dli_triplet
            real*8 :: bli_triplet
            real*8 :: log_4rm
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /triplet_data/ a_triplet,b_triplet,dl_triplet,dli_triplet,bli_triplet,log_4rm
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end subroutine init_triplet
        subroutine edgset(nreglo,nreghi) ! in :egsfortran:tutor4_linux.f
            integer :: nreglo
            integer :: nreghi
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /x_options/ eadl_relax,mcdf_pe_xsections
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine edgset
        subroutine photon(ircode,howfar) ! in :egsfortran:tutor4_linux.f
            use photon__user__routines
            use electr__user__routines, ausgab=>ausgab
            intent (callback,hide) ausgab
            external ausgab
            integer*4 :: ircode
            external howfar
            logical :: qdebug
            real*8 dimension(3) :: ecut
            real*8 dimension(3) :: pcut
            real*8 :: vacdst
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /qdebug/ qdebug
            common /bounds/ ecut,pcut,vacdst
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine photon
        subroutine uphi(ientry,lvl) ! in :egsfortran:tutor4_linux.f
            integer :: ientry
            integer :: lvl
            logical :: qdebug
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: sinc0
            real*8 :: sinc1
            real*8 dimension(1002) :: sin0
            real*8 dimension(1002) :: sin1
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /qdebug/ qdebug
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /uphiin/ sinc0,sinc1,sin0,sin1
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /randomm/ rng_array,seeds,rng_seed
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine uphi
        subroutine init_nist_brems ! in :egsfortran:tutor4_linux.f
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(51,100,1) :: nb_fdata
            real*8 dimension(51,100,1) :: nb_xdata
            real*8 dimension(50,100,1) :: nb_wdata
            integer*4 dimension(50,100,1) :: nb_idata
            real*8 dimension(1) :: nb_emin
            real*8 dimension(1) :: nb_emax
            real*8 dimension(1) :: nb_lemin
            real*8 dimension(1) :: nb_lemax
            real*8 dimension(1) :: nb_dle
            real*8 dimension(1) :: nb_dlei
            real*8 dimension(1) :: log_ap
            real*4 dimension(1,2,32,16,32) :: spin_rej
            real*4 :: espin_min
            real*4 :: espin_max
            real*4 :: espml
            real*4 :: b2spin_min
            real*4 :: b2spin_max
            real*4 :: dbeta2
            real*4 :: dbeta2i
            real*4 :: dlener
            real*4 :: dleneri
            real*4 :: dqq1
            real*4 :: dqq1i
            logical :: fool_intel_optimizer
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /nist_brems/ nb_fdata,nb_xdata,nb_wdata,nb_idata,nb_emin,nb_emax,nb_lemin,nb_lemax,nb_dle,nb_dlei,log_ap
            common /spin_data/ spin_rej,espin_min,espin_max,espml,b2spin_min,b2spin_max,dbeta2,dbeta2i,dlener,dleneri,dqq1,dqq1i,fool_intel_optimizer
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine init_nist_brems
        subroutine init_nrc_pair ! in :egsfortran:tutor4_linux.f
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(65,84,1) :: nrcp_fdata
            real*8 dimension(65,84,1) :: nrcp_wdata
            integer*4 dimension(65,84,1) :: nrcp_idata
            real*8 dimension(65) :: nrcp_xdata
            real*8 :: nrcp_emin
            real*8 :: nrcp_emax
            real*8 :: nrcp_dle
            real*8 :: nrcp_dlei
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /nrc_pair/ nrcp_fdata,nrcp_wdata,nrcp_idata,nrcp_xdata,nrcp_emin,nrcp_emax,nrcp_dle,nrcp_dlei
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine init_nrc_pair
        subroutine vmc_electron(ircode) ! in :egsfortran:tutor4_linux.f
            integer*4 :: ircode
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine vmc_electron
        subroutine egs_init_default_rng ! in :egsfortran:tutor4_linux.f
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            common /randomm/ rng_array,seeds,rng_seed
        end subroutine egs_init_default_rng
        subroutine egs_init_rng(arg1,arg2) ! in :egsfortran:tutor4_linux.f
            integer*4 :: arg1
            integer*4 :: arg2
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            common /randomm/ rng_array,seeds,rng_seed
        end subroutine egs_init_rng
        subroutine egs_get_rndm(ran) ! in :egsfortran:tutor4_linux.f
            real*8 :: ran
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            common /randomm/ rng_array,seeds,rng_seed
        end subroutine egs_get_rndm
        subroutine egs_get_rndm_array(n,rarray) ! in :egsfortran:tutor4_linux.f
            integer*4 :: n
            real*8 dimension(*) :: rarray
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            common /randomm/ rng_array,seeds,rng_seed
        end subroutine egs_get_rndm_array
        subroutine eii_init ! in :egsfortran:tutor4_linux.f
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(10000) :: eii_xsection_a
            real*8 dimension(10000) :: eii_xsection_b
            real*8 dimension(1) :: eii_cons
            real*8 dimension(40) :: eii_a
            real*8 dimension(40) :: eii_b
            real*8 :: eii_l_factor
            integer*4 dimension(40) :: eii_z
            integer*4 dimension(40) :: eii_sh
            integer*4 dimension(100) :: eii_nshells
            integer*4 dimension(1) :: eii_nsh
            integer*4 dimension(1,50) :: eii_first
            integer*4 dimension(1,50) :: eii_no
            integer*4 :: eii_flag
            real*8 dimension(1) :: esig_e
            real*8 dimension(1) :: psig_e
            real*8 :: esige_max
            real*8 :: psige_max
            real*8 dimension(2,500,1) :: range_ep
            real*8 dimension(500,1) :: e_array
            real*8 dimension(500,1) :: etae_ms0
            real*8 dimension(500,1) :: etae_ms1
            real*8 dimension(500,1) :: etap_ms0
            real*8 dimension(500,1) :: etap_ms1
            real*8 dimension(500,1) :: q1ce_ms0
            real*8 dimension(500,1) :: q1ce_ms1
            real*8 dimension(500,1) :: q1cp_ms0
            real*8 dimension(500,1) :: q1cp_ms1
            real*8 dimension(500,1) :: q2ce_ms0
            real*8 dimension(500,1) :: q2ce_ms1
            real*8 dimension(500,1) :: q2cp_ms0
            real*8 dimension(500,1) :: q2cp_ms1
            real*8 dimension(500,1) :: blcce0
            real*8 dimension(500,1) :: blcce1
            real*8 dimension(1) :: eke0
            real*8 dimension(1) :: eke1
            real*8 dimension(1) :: xr0
            real*8 dimension(1) :: teff0
            real*8 dimension(1) :: blcc
            real*8 dimension(1) :: xcc
            real*8 dimension(500,1) :: esig0
            real*8 dimension(500,1) :: esig1
            real*8 dimension(500,1) :: psig0
            real*8 dimension(500,1) :: psig1
            real*8 dimension(500,1) :: ededx0
            real*8 dimension(500,1) :: ededx1
            real*8 dimension(500,1) :: pdedx0
            real*8 dimension(500,1) :: pdedx1
            real*8 dimension(500,1) :: ebr10
            real*8 dimension(500,1) :: ebr11
            real*8 dimension(500,1) :: pbr10
            real*8 dimension(500,1) :: pbr11
            real*8 dimension(500,1) :: pbr20
            real*8 dimension(500,1) :: pbr21
            real*8 dimension(500,1) :: tmxs0
            real*8 dimension(500,1) :: tmxs1
            real*8 dimension(1) :: expeke1
            integer*4 dimension(1) :: iunrst
            integer*4 dimension(1) :: epstfl
            integer*4 dimension(1) :: iaprim
            logical dimension(2,1) :: sig_ismonotone
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /eii_data/ eii_xsection_a,eii_xsection_b,eii_cons,eii_a,eii_b,eii_l_factor,eii_z,eii_sh,eii_nshells,eii_nsh,eii_first,eii_no,eii_flag
            common /elecin/ esig_e,psig_e,esige_max,psige_max,range_ep,e_array,etae_ms0,etae_ms1,etap_ms0,etap_ms1,q1ce_ms0,q1ce_ms1,q1cp_ms0,q1cp_ms1,q2ce_ms0,q2ce_ms1,q2cp_ms0,q2cp_ms1,blcce0,blcce1,eke0,eke1,xr0,teff0,blcc,xcc,esig0,esig1,psig0,psig1,ededx0,ededx1,pdedx0,pdedx1,ebr10,ebr11,pbr10,pbr11,pbr20,pbr21,tmxs0,tmxs1,expeke1,iunrst,epstfl,iaprim,sig_ismonotone
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end subroutine eii_init
        subroutine eii_sample(ish,iz,uj) ! in :egsfortran:tutor4_linux.f
            integer*4 :: ish
            integer*4 :: iz
            real*8 :: uj
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            real*8 dimension(10000) :: eii_xsection_a
            real*8 dimension(10000) :: eii_xsection_b
            real*8 dimension(1) :: eii_cons
            real*8 dimension(40) :: eii_a
            real*8 dimension(40) :: eii_b
            real*8 :: eii_l_factor
            integer*4 dimension(40) :: eii_z
            integer*4 dimension(40) :: eii_sh
            integer*4 dimension(100) :: eii_nshells
            integer*4 dimension(1) :: eii_nsh
            integer*4 dimension(1,50) :: eii_first
            integer*4 dimension(1,50) :: eii_no
            integer*4 :: eii_flag
            real*8 dimension(3) :: e_max_rr
            real*8 :: prob_rr
            integer*4 :: nbr_split
            integer*4 :: i_play_rr
            integer*4 :: i_survived_rr
            integer*4 :: n_rr_warning
            integer*2 dimension(3) :: i_do_rr
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            real*8 :: theta
            real*8 :: sinthe
            real*8 :: costhe
            real*8 :: sinphi
            real*8 :: cosphi
            real*8 :: pi
            real*8 :: twopi
            real*8 :: pi5d2
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            integer*4 dimension(3000) :: relax_first
            integer*4 dimension(3000) :: relax_ntran
            integer*4 dimension(10000) :: relax_state
            real*8 dimension(10000) :: relax_prob
            integer*4 dimension(10000) :: relax_atbin
            integer*4 :: relax_ntot
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /eii_data/ eii_xsection_a,eii_xsection_b,eii_cons,eii_a,eii_b,eii_l_factor,eii_z,eii_sh,eii_nshells,eii_nsh,eii_first,eii_no,eii_flag
            common /egs_vr/ e_max_rr,prob_rr,nbr_split,i_play_rr,i_survived_rr,n_rr_warning,i_do_rr
            common /randomm/ rng_array,seeds,rng_seed
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /uphiot/ theta,sinthe,costhe,sinphi,cosphi,pi,twopi,pi5d2
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /relax_data/ relax_first,relax_ntran,relax_state,relax_prob,relax_atbin,relax_ntot
        end subroutine eii_sample
        subroutine egs_scale_photon_xsection(imed,fac,which) ! in :egsfortran:tutor4_linux.f
            integer*4 :: imed
            real*8 :: fac
            integer*4 :: which
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
        end subroutine egs_scale_photon_xsection
        subroutine egs_init_user_photon(prefix,comp_prefix,photonuc_prefix,out) ! in :egsfortran:tutor4_linux.f
            character*(*) :: prefix
            character*(*) :: comp_prefix
            character*(*) :: photonuc_prefix
            integer*4 :: out
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(30,100) :: binding_energies
            real*8 dimension(6,100) :: interaction_prob
            real*8 dimension(39,100) :: relaxation_prob
            real*8 dimension(16,100) :: edge_energies
            integer*4 dimension(100) :: edge_number
            real*8 dimension(16,100) :: edge_a
            real*8 dimension(16,100) :: edge_b
            real*8 dimension(16,100) :: edge_c
            real*8 dimension(16,100) :: edge_d
            integer*2 dimension(3) :: iedgfl
            integer*2 dimension(3) :: iphter
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            integer*4 dimension(1538) :: iz_array
            real*8 dimension(1538) :: be_array
            real*8 dimension(1538) :: jo_array
            real*8 dimension(1538) :: erfjo_array
            integer*4 dimension(1538) :: ne_array
            integer*4 dimension(1538) :: shn_array
            integer*4 dimension(200,1) :: shell_array
            real*8 dimension(200,1) :: eno_array
            integer*4 dimension(200,1) :: eno_atbin_array
            integer*4 dimension(1) :: n_shell
            integer*4 :: radc_flag
            integer*2 dimension(3) :: ibcmp
            logical :: eadl_relax
            logical :: mcdf_pe_xsections
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /edge/ binding_energies,interaction_prob,relaxation_prob,edge_energies,edge_number,edge_a,edge_b,edge_c,edge_d,iedgfl,iphter
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /compton_data/ iz_array,be_array,jo_array,erfjo_array,ne_array,shn_array,shell_array,eno_array,eno_atbin_array,n_shell,radc_flag,ibcmp
            common /x_options/ eadl_relax,mcdf_pe_xsections
        end subroutine egs_init_user_photon
        subroutine egs_init_rayleigh(medium,sig_rayleigh) ! in :egsfortran:tutor4_linux.f
            integer*4 :: medium
            real*8 dimension(2000) :: sig_rayleigh
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            character dimension(1,24),intent(c) :: iray_ff_media
            character dimension(1,128),intent(c) :: iray_ff_file
            real*8 dimension(100,1) :: xgrid
            real*8 dimension(100,1) :: fcum
            real*8 dimension(100,1) :: b_array
            real*8 dimension(100,1) :: c_array
            integer*4 dimension(100,1) :: i_array
            real*8 dimension(2000,1) :: pmax0
            real*8 dimension(2000,1) :: pmax1
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /rayleigh_inputs/ iray_ff_media,iray_ff_file
            common /rayleigh_sampling/ xgrid,fcum,b_array,c_array,i_array,pmax0,pmax1
        end subroutine egs_init_rayleigh
        subroutine egs_init_rayleigh_sampling(medium) ! in :egsfortran:tutor4_linux.f
            integer*4 :: medium
            real*8 :: rmt2
            real*8 :: rmsq
            real*8 dimension(1) :: ap
            real*8 dimension(1) :: ae
            real*8 dimension(1) :: up
            real*8 dimension(1) :: ue
            real*8 dimension(1) :: te
            real*8 dimension(1) :: thmoll
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 :: dunit
            integer*4 :: kmpi
            integer*4 :: kmpo
            real*8 dimension(3) :: rhor
            integer*2 dimension(3) :: med
            integer*2 dimension(3) :: iraylr
            integer*2 dimension(3) :: iphotonucr
            real*8 dimension(1) :: ebinda
            real*8 dimension(1) :: ge0
            real*8 dimension(1) :: ge1
            real*8 dimension(2000,1) :: gmfp0
            real*8 dimension(2000,1) :: gmfp1
            real*8 dimension(2000,1) :: gbr10
            real*8 dimension(2000,1) :: gbr11
            real*8 dimension(2000,1) :: gbr20
            real*8 dimension(2000,1) :: gbr21
            real*8 dimension(1) :: rco0
            real*8 dimension(1) :: rco1
            real*8 dimension(100,1) :: rsct0
            real*8 dimension(100,1) :: rsct1
            real*8 dimension(2000,1) :: cohe0
            real*8 dimension(2000,1) :: cohe1
            real*8 dimension(2000,1) :: photonuc0
            real*8 dimension(2000,1) :: photonuc1
            real*8 :: dpmfp
            integer*4 dimension(1,1) :: mpgem
            integer*4 dimension(1) :: ngr
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            character dimension(1,24),intent(c) :: iray_ff_media
            character dimension(1,128),intent(c) :: iray_ff_file
            real*8 dimension(100,1) :: xgrid
            real*8 dimension(100,1) :: fcum
            real*8 dimension(100,1) :: b_array
            real*8 dimension(100,1) :: c_array
            integer*4 dimension(100,1) :: i_array
            real*8 dimension(2000,1) :: pmax0
            real*8 dimension(2000,1) :: pmax1
            common /thresh/ rmt2,rmsq,ap,ae,up,ue,te,thmoll
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /misc/ dunit,kmpi,kmpo,rhor,med,iraylr,iphotonucr
            common /photin/ ebinda,ge0,ge1,gmfp0,gmfp1,gbr10,gbr11,gbr20,gbr21,rco0,rco1,rsct0,rsct1,cohe0,cohe1,photonuc0,photonuc1,dpmfp,mpgem,ngr
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /rayleigh_inputs/ iray_ff_media,iray_ff_file
            common /rayleigh_sampling/ xgrid,fcum,b_array,c_array,i_array,pmax0,pmax1
        end subroutine egs_init_rayleigh_sampling
        function egs_rayleigh_sigma(imed,e,ndat,x,f) ! in :egsfortran:tutor4_linux.f
            integer*4 :: imed
            real*8 :: e
            integer*4 :: ndat
            real*8 dimension(100) :: x
            real*8 dimension(100) :: f
            real*8 :: egs_rayleigh_sigma
        end function egs_rayleigh_sigma
        subroutine egs_rayleigh_sampling(medium,e,gle,lgle,costhe,sinthe) ! in :egsfortran:tutor4_linux.f
            integer*4 :: medium
            real*8 :: e
            real*8 :: gle
            integer*4 :: lgle
            real*8 :: costhe
            real*8 :: sinthe
            real*8 dimension(24) :: rng_array
            integer*4 dimension(25) :: seeds
            integer*4 :: rng_seed
            real*8 dimension(100,1) :: xgrid
            real*8 dimension(100,1) :: fcum
            real*8 dimension(100,1) :: b_array
            real*8 dimension(100,1) :: c_array
            integer*4 dimension(100,1) :: i_array
            real*8 dimension(2000,1) :: pmax0
            real*8 dimension(2000,1) :: pmax1
            common /randomm/ rng_array,seeds,rng_seed
            common /rayleigh_sampling/ xgrid,fcum,b_array,c_array,i_array,pmax0,pmax1
        end subroutine egs_rayleigh_sampling
        subroutine prepare_rayleigh_data(ndat,x,f,ne,emin,emax,pe_array,ncbin,fcum,i_array,b_array,c_array) ! in :egsfortran:tutor4_linux.f
            integer*4, optional,check(len(x)>=ndat),depend(x) :: ndat=len(x)
            real*8 dimension(ndat) :: x
            real*8 dimension(ndat),depend(ndat) :: f
            integer*4, optional,check(len(pe_array)>=ne),depend(pe_array) :: ne=len(pe_array)
            real*8 :: emin
            real*8 :: emax
            real*8 dimension(ne) :: pe_array
            integer*4, optional,check(len(i_array)>=ncbin),depend(i_array) :: ncbin=len(i_array)
            real*8 dimension(ndat),depend(ndat) :: fcum
            integer*4 dimension(ncbin) :: i_array
            real*8 dimension(ndat),depend(ndat) :: b_array
            real*8 dimension(ndat),depend(ndat) :: c_array
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end subroutine prepare_rayleigh_data
        function egs_kn_sigma0(e) ! in :egsfortran:tutor4_linux.f
            real*8 :: e
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 :: egs_kn_sigma0
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end function egs_kn_sigma0
        function egs_kn_sigma1(e) ! in :egsfortran:tutor4_linux.f
            real*8 :: e
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 :: egs_kn_sigma1
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end function egs_kn_sigma1
        subroutine egsi_get_data(flag,iunit,n,ne,zsorted,pz_sorted,ge1,ge0,data) ! in :egsfortran:tutor4_linux.f
            integer*4 :: flag
            integer*4 :: iunit
            integer*4 :: n
            integer*4 :: ne
            real*8 dimension(*) :: zsorted
            real*8 dimension(*) :: pz_sorted
            real*8 :: ge1
            real*8 :: ge0
            real*8 dimension(*) :: data
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end subroutine egsi_get_data
        subroutine egsi_get_shell_data(imed,n,ne,zsorted,pz_sorted,ge1,ge0,data) ! in :egsfortran:tutor4_linux.f
            integer*4 :: imed
            integer*4 :: n
            integer*4 :: ne
            real*8 dimension(*) :: zsorted
            real*8 dimension(*) :: pz_sorted
            real*8 :: ge1
            real*8 :: ge0
            real*8 dimension(*) :: data
            character dimension(20,10),intent(c) :: file_extensions
            integer*4 dimension(20) :: file_units
            character*64 :: user_code
            character*256 :: input_file
            character*256 :: output_file
            character*256 :: pegs_file
            character*128 :: hen_house
            character*128 :: egs_home
            character*128 :: work_dir
            character*64 :: host_name
            integer*4 :: n_parallel
            integer*4 :: i_parallel
            integer*4 :: first_parallel
            integer*4 :: n_max_parallel
            integer*4 :: n_chunk
            integer*4 :: n_files
            integer*4 :: i_input
            integer*4 :: i_log
            integer*4 :: i_incoh
            integer*4 :: i_nist_data
            integer*4 :: i_mscat
            integer*4 :: i_photo_cs
            integer*4 :: i_photo_relax
            integer*4 :: xsec_out
            logical :: is_batch
            logical :: is_pegsless
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            real*8 dimension(1) :: rlc
            real*8 dimension(1) :: rldu
            real*8 dimension(1) :: rho
            integer*4 dimension(1) :: msge
            integer*4 dimension(1) :: mge
            integer*4 dimension(1) :: mseke
            integer*4 dimension(1) :: meke
            integer*4 dimension(1) :: mleke
            integer*4 dimension(1) :: mcmfp
            integer*4 dimension(1) :: mrange
            integer*4 dimension(1) :: iraylm
            integer*4 dimension(1) :: iphotonucm
            character dimension(24,1,4),intent(c) :: media
            character*16 :: photon_xsections
            character*16 :: comp_xsections
            character*16 :: photonuc_xsections
            character*16 :: eii_xfile
            integer*4 :: iphotonuc
            integer*4 :: nmed
            real*8 dimension(500,100,17) :: pe_xsection
            real*8 dimension(500,100,1) :: pe_elem_prob
            real*8 dimension(500,100) :: pe_energy
            integer*4 dimension(100,1) :: pe_zsorted
            real*8 dimension(100,16) :: pe_be
            integer*4 dimension(100) :: pe_nshell
            integer*4 dimension(100) :: pe_zpos
            integer*4 dimension(100) :: pe_nge
            integer*4 :: pe_ne
            common /egs_io/ file_extensions,file_units,user_code,input_file,output_file,pegs_file,hen_house,egs_home,work_dir,host_name,n_parallel,i_parallel,first_parallel,n_max_parallel,n_chunk,n_files,i_input,i_log,i_incoh,i_nist_data,i_mscat,i_photo_cs,i_photo_relax,xsec_out,is_batch,is_pegsless
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /useful/ pzero,prm,prmt2,rm,medium,medold
            common /media/ rlc,rldu,rho,msge,mge,mseke,meke,mleke,mcmfp,mrange,iraylm,iphotonucm,media,photon_xsections,comp_xsections,photonuc_xsections,eii_xfile,iphotonuc,nmed
            common /pe_shell_data/ pe_xsection,pe_elem_prob,pe_energy,pe_zsorted,pe_be,pe_nshell,pe_zpos,pe_nge,pe_ne
        end subroutine egsi_get_shell_data
        function sigmamedium(imed,loge) ! in :egsfortran:tutor4_linux.f
            integer*4 :: imed
            real*8 :: loge
            real*8 dimension(8,1) :: dl1
            real*8 dimension(8,1) :: dl2
            real*8 dimension(8,1) :: dl3
            real*8 dimension(8,1) :: dl4
            real*8 dimension(8,1) :: dl5
            real*8 dimension(8,1) :: dl6
            real*8 dimension(2,1) :: alphi
            real*8 dimension(2,1) :: bpar
            real*8 dimension(2,1) :: delpos
            real*8 dimension(1,50) :: wa
            real*8 dimension(1,50) :: pz
            real*8 dimension(1,50) :: zelem
            real*8 dimension(1,50) :: rhoz
            real*8 dimension(50) :: pwr2i
            real*8 dimension(1) :: delcm
            real*8 dimension(1) :: zbrang
            real*8 dimension(1) :: lzbrang
            integer*4 dimension(1) :: nne
            integer*4 :: ibrdst
            integer*4 :: iprdst
            integer*4 :: ibr_nist
            integer*4 :: pair_nrc
            integer*4 :: itriplet
            character dimension(1,50,2,4),intent(c) :: asym
            real*8 dimension(500,100,17) :: pe_xsection
            real*8 dimension(500,100,1) :: pe_elem_prob
            real*8 dimension(500,100) :: pe_energy
            integer*4 dimension(100,1) :: pe_zsorted
            real*8 dimension(100,16) :: pe_be
            integer*4 dimension(100) :: pe_nshell
            integer*4 dimension(100) :: pe_zpos
            integer*4 dimension(100) :: pe_nge
            integer*4 :: pe_ne
            real*8 :: sigmamedium
            common /brempr/ dl1,dl2,dl3,dl4,dl5,dl6,alphi,bpar,delpos,wa,pz,zelem,rhoz,pwr2i,delcm,zbrang,lzbrang,nne,ibrdst,iprdst,ibr_nist,pair_nrc,itriplet,asym
            common /pe_shell_data/ pe_xsection,pe_elem_prob,pe_energy,pe_zsorted,pe_be,pe_nshell,pe_zpos,pe_nge,pe_ne
        end function sigmamedium
        subroutine egs_heap_sort(n,rarray,jarray) ! in :egsfortran:tutor4_linux.f
            integer*4 :: n
            real*8 dimension(*) :: rarray
            integer*4 dimension(*) :: jarray
        end subroutine egs_heap_sort
        subroutine photonuc ! in :egsfortran:tutor4_linux.f
            double precision dimension(15) :: e
            real*8 dimension(15) :: x
            real*8 dimension(15) :: y
            real*8 dimension(15) :: z
            real*8 dimension(15) :: u
            real*8 dimension(15) :: v
            real*8 dimension(15) :: w
            real*8 dimension(15) :: dnear
            real*8 dimension(15) :: wt
            integer*4 dimension(15) :: iq
            integer*4 dimension(15) :: ir
            integer*4 dimension(15) :: latch
            integer*4 :: latchi
            integer*4 :: np
            integer*4 :: npold
            double precision :: edep
            double precision :: edep_local
            real*8 :: tstep
            real*8 :: tustep
            real*8 :: ustep
            real*8 :: tvstep
            real*8 :: vstep
            real*8 :: rhof
            real*8 :: eold
            real*8 :: enew
            real*8 :: eke
            real*8 :: elke
            real*8 :: gle
            real*8 :: e_range
            real*8 :: x_final
            real*8 :: y_final
            real*8 :: z_final
            real*8 :: u_final
            real*8 :: v_final
            real*8 :: w_final
            integer*4 :: idisc
            integer*4 :: irold
            integer*4 :: irnew
            integer*4 dimension(55) :: iausfl
            double precision, optional :: pzero=0.d0
            double precision, optional :: prm=0.5109989461
            double precision, optional :: prmt2=1.0219978922
            real*8, optional :: rm=0.5109989461
            integer*4 :: medium
            integer*4 :: medold
            common /stack/ e,x,y,z,u,v,w,dnear,wt,iq,ir,latch,latchi,np,npold
            common /epcont/ edep,edep_local,tstep,tustep,ustep,tvstep,vstep,rhof,eold,enew,eke,elke,gle,e_range,x_final,y_final,z_final,u_final,v_final,w_final,idisc,irold,irnew,iausfl
            common /useful/ pzero,prm,prmt2,rm,medium,medold
        end subroutine photonuc
    end interface
end python module egsfortran

! This file was auto-generated with f2py (version:2).
! See http://cens.ioc.ee/projects/f2py2e/
